global:
  slack_api_url: 'https://hooks.slack.com/services/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'
  #telegram_api_url: https://api.telegram.org
  resolve_timeout: 1m

receivers:
  - name: print-alert-routing
    webhook_configs:
    - url: http://108.61.86.13:5001

  - name: 'telegram'
    telegram_configs:
    - bot_token: '5569858800:AAFvPtXPBXCpXdLDR_85lpJdLU6n3vsD7Zc' 
      chat_id: -713630851
      api_url: "https://api.telegram.org"
      parse_mode: 'HTML'
      message: "{{ template \"telegram.default.message\" .}}"

  - name: 'slack-notifications'
    slack_configs:
    - channel: 'alert'
      send_resolved: true
      color: '{{ template "slack.default.color" . }}'
      title: '{{ template "slack.default.title" . }}'
      title_link: '{{ template "slack.default.titlelink" . }}'
      text: |-
        {{ if eq .Status "firing" }}{{ if eq .GroupLabels.severity "critical"}}<!channel>{{ end }}{{ end }}
        {{ range .Alerts }}
          *Description:* {{ .Annotations.description }}
          *Details:*
          {{ range .Labels.SortedPairs }} â€¢ *{{ .Name }}:* `{{ .Value }}`
          {{ end }}
        {{ end }}
      fallback: '{{ template "slack.default.fallback" . }}'
      icon_emoji: '{{ template "slack.default.iconemoji" . }}'
      icon_url: '{{ template "slack.default.iconurl" . }}'

templates: 
  - '/etc/alertmanager/template-notification.tmpl'


route:
  group_by: [alertname, severity]
  group_wait: 10s
  group_interval: 30s
  receiver: print-alert-routing
  repeat_interval: 30m
  routes:
  - receiver: slack-notifications
    continue: true

  - receiver: print-alert-routing
    continue: true

  - receiver: telegram
    continue: true